<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>FLAME</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>

<style>
    model-viewer {
        width: 800px;
        height: 600px;
     }
        input[type=range]::-webkit-slider-thumb {
        height : 75px;
        width : 75px;
     }
     button {
        padding: 20px;
        width: 300px;
        text-align: center;
        font-size: 28px;
        background-color: transparent;
        border-radius: 4px;
        border: none;
        position: absolute;
        top: 16px;
        right: 16px;
      }
</style>
</head>

<body>
<h2>Demo 2, Mechanical Engineering: Radial Compressor</h2>
<p>The animations are created in Blender and exported in a binary glTF format (khronos Group).
This exmaple allows interaction with a 3D model of a turbocharger compressor stage. Use the sliders to control the rotation of the impeller and the twist of the blades.
This can help students better understand the velocity triangles used to describe the flow direction in these complex shapes which is notoriously difficult in 2D images.</p>
<model-viewer 
    id="compressor-demo"
    src="https://nolankucd.github.io/FLAME/compressor.glb"
    scale="0.2 0.2 0.2"
    autoplay animation-name="spin" 
    ar 
    ar-scale="auto" 
    camera-controls
    alt="A compressor"
    xr-environment
    background-color="#ffffff">
    <button slot="ar-button">
      ðŸ”¥ View in AR ðŸ”¥
    </button>
</model-viewer>
    <div class="controls">
        <div>
            <p>Speed: <span id="speed-value"></span></p>
            <input id="speed" type="range" style="width: 400px;" style="width: 100px;" min="0" max="1" step="0.01" value="1">
        </div>
        <div>
            <p>Twist: <span id="twist-value"></span></p>
            <input id="twist" type="range" style="width: 400px;" style="width: 100px;" min="0" max="2" step="0.01" value="0">
        </div>
    </div>

<script type="module">
const modelViewer = document.querySelector("#compressor-demo");
const speedSlider = document.querySelector("#speed");
const twistSlider = document.querySelector("#twist");

modelViewer.interactionPrompt = 'none';

speedSlider.addEventListener("input", (event) => {
  modelViewer.animationName = 'spin';
  modelViewer.timeScale = event.target.value;
  modelViewer.play();
});

twistSlider.addEventListener('input', event => {
  modelViewer.animationName = 'twist';
  modelViewer.timeScale = 1;
  modelViewer.currentTime = event.target.value;
  modelViewer.pause();
});

const play = () => {
  modelViewer.play();
};

modelViewer.addEventListener('load', play);
modelViewer.addEventListener('finished', play);

</script>
  
</body>
</html>
